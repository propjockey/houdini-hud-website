const t=(await WebAssembly.instantiateStreaming(fetch(new URL("./main.wasm",import.meta.url).toString()))).instance.exports,e=t.get_tag,s=t.memory,r=t.parse,i=t.reset,n=new Uint8Array(s.buffer),l=new Uint32Array(s.buffer);let a,o,h;const u=new TextEncoder,c=new TextDecoder,f=(t,e,s)=>c.decode(t.slice(e,s));let d;const p=(t,e)=>f(h,t,e),m={"attach-template":{flag:256,feat:0,prop:"attachTemplate",read(t){let e=(t.ownerDocument||document).createElement("template");return e.content.append(...Array.from(t.childNodes)),e}},attr:{flag:64,feat:13,prop:"attr",longhand:["attr-value","attr-toggle"],defaults:["",!0]},"attr-value":{flag:64,feat:2,shorthand:"attr",index:0,default:"",read:(t,e)=>"getAttribute"in t&&t.getAttribute(e)},"attr-toggle":{flag:64,feat:2,shorthand:"attr",index:1,default:!0,read:(t,e)=>"hasAttribute"in t&&t.hasAttribute(e)},"class-toggle":{flag:2,feat:12,prop:"classToggle",read:(t,e)=>"classList"in t&&t.classList.contains(e)},data:{flag:128,feat:12,prop:"data",read(t,e){if(!("dataset"in t))throw new Error("data can only be used on HTMLElements");return t.dataset[e]}},each:{flag:16,feat:1,prop:"each",longhand:["each-items","each-template","each-key"],defaults:[[],{},null]},"each-items":{flag:16,feat:2,shorthand:"each",index:0,default:[],read:()=>null},"each-template":{flag:16,feat:2,shorthand:"each",index:1,default:{},read:()=>null},"each-key":{flag:16,feat:2,shorthand:"each",index:2,default:null,read:()=>null},event:{flag:4,feat:93,prop:"event",longhand:["event-type","event-listener","event-capture","event-once","event-passive","event-signal"],defaults:[null,!1,!1,!1,void 0]},"event-type":{flag:4,feat:70,shorthand:"event",index:0,default:null,read:()=>null},"event-listener":{flag:4,feat:66,shorthand:"event",index:1,default:null,read:()=>null},"event-capture":{flag:4,feat:66,shorthand:"event",index:2,default:!1,read:()=>!1},"event-once":{flag:4,feat:66,shorthand:"event",index:3,default:!1,read:()=>!1},"event-passive":{flag:4,feat:66,shorthand:"event",index:4,default:!1,read:()=>!1},"event-signal":{flag:4,feat:66,shorthand:"event",index:5,default:void 0,read:()=>{}},behavior:{flag:512,feat:56,prop:"behavior"},prop:{flag:32,feat:12,prop:"prop",read:(t,e)=>t[e]},text:{flag:1,feat:0,prop:"text",read:t=>t.textContent},"store-root":{flag:1024,feat:0,prop:"storeRoot",read:()=>null},"store-set":{flag:2048,feat:0,prop:"storeSet",read:()=>null}};class g{constructor(t,e,s,r){this.rule=t,this.propertyName=e,this.keyTemplate=null,this.sourceOrder=s,this.template=r,this.flags=0}init(){let t=m[this.propertyName];t&&(8&t.feat&&(this.flags|=b.multi),64&t.feat&&(this.flags|=b.label),2&t.feat?this.flags|=b.longhand:1&t.feat?this.flags|=b.shorthand:32&t.feat&&(this.flags|=b.behavior))}}const b={shorthand:1,longhand:2,multi:4,behavior:8,label:16},v=t=>[t];function y(t){return t.querySelectorAll(this.selector)}class w{constructor(t){this.selector=t,this.declarations=[],this.specificity=0,this.querySelectorAll=":root"===t?v:y}addDeclaration(t){this.declarations.push(t)}}var k=0;function x(t){return"__private_"+k+++"_"+t}function O(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}function M(t,e,s){let r=t;do{if(r.matches(e))return r[Symbol.for(s)];r=t.closest(e)}while(r)}function S(t,e,s,r,i,n){let l=t,a=l[e];a||(a=l[e]=new Set),a.add(s);let o=Array.from(a).join(" ");t.dataset[i]=o,l[r]=n}function V(t,e,s,r,i){let n=t,l=n[e];if(l)if(l.delete(s),delete n[r],l.size){let e=Array.from(l).join(" ");t.dataset[i]=e}else delete n[r],delete t.dataset[i]}const E=Symbol.for("corset.getKey");var P=/*#__PURE__*/x("update");class j extends Map{constructor(t,e=!0){super(),Object.defineProperty(this,P,{writable:!0,value:void 0}),this.root=t,O(this,P)[P]=e?this.root.mount?this.root.mount.update.bind(this.root.mount):Function.prototype:this.root.update.bind(this.root)}[E](t){return this.get(t)}set(t,e){return super.set(t,e),O(this,P)[P](),this}}const A=t=>`corset.store.${t}`,D=t=>`[data-corset-stores~=${t}]`,T=Symbol("corset.noValue"),L=t=>class{get(){return t}};class C{constructor(){this.current=0,this.value=T}check([t],e,s,{values:r}){let i=r[t];return this.value!==i&&(this.value=i,!0)}get(){return this.value}}class W{get(t=[]){return t}}class F extends W{}var N=/*#__PURE__*/x("get");class U{constructor(){Object.defineProperty(this,N,{value:$}),this.current=0,this.compute=T,this.value=null}check(t,e,s,r){let i=!1;if(r.selectors)i=!0;else{if(this.compute!==T){this.compute.dirty(r);let t=this.compute.check(r);return t!==this.value&&(this.value=t,!0)}i=!0}if(i){let s=O(this,N)[N](t,e);if(s)return(s.value!==this.value||s.compute!==this.compute)&&(this.compute=s.compute,this.value=s.value,!0);if(t.length>1){let e=t[1];return!(this.value&&e===this.value[0]||(this.value=[e],0))}}return!1}get(){return this.value}}function $(t,{element:e}){let[s]=t;return M(e,`[data-corset-props~=${s}]`,s)}const q=t=>{let e=t.prototype;if("object"!=typeof e)throw new Error("Functions must contain a prototype");let s=e.call;class r{constructor(e){this.context=Object.create(e,{createStore:{value:()=>new j(e.root,!1)}}),this.fn=new t}get(t,e,r){return s.call(this.fn,t,r,this.context)}}if(r.inputProperties=t.inputProperties,e.check){let t=e.check;r.prototype.check=function(e,s,r,i){return t.call(this.fn,e,r,this.context,i)}}return r};var K=/*#__PURE__*/x("initial"),H=/*#__PURE__*/x("value"),R=/*#__PURE__*/x("dirty"),B=/*#__PURE__*/x("check"),_=/*#__PURE__*/x("allDeps");class z{constructor(t,e,s=0){Object.defineProperty(this,_,{value:I}),Object.defineProperty(this,K,{writable:!0,value:!0}),Object.defineProperty(this,H,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:new WeakMap}),Object.defineProperty(this,B,{writable:!0,value:void 0}),this.binding=e,this.index=s,this.args=[],this.argDeps=[],this.inputDeps=null,this.inputProps=null,this.raw=function(t,e){let s=new e.Value(t.binding);for(let s of e.deps)t.argDeps.push(new z(s,t.binding));let r=e.inputProperties;if(r){t.inputProps=new Map,t.inputDeps=new Map;for(let[e,s]of r)t.inputDeps.set(e,new z(s,t.binding))}return s}(this,t),this.listValue=this.raw instanceof W?()=>O(this,H)[H]:()=>[O(this,H)[H]],O(this,H)[H]=null,O(this,B)[B]=this.raw.check}set(t,e,s){let r=this.argDeps;r[t]!==e&&O(this,R)[R].set(s,!0),r[t]=e}dirty(t){return O(this,K)[K]&&(this.calculate(t),O(this,R)[R].set(t,!0),O(this,K)[K]=!1),O(this,R)[R].has(t)||this.calculate(t),O(this,R)[R].get(t)}compute(t){O(this,H)[H]=G(this,t,this.raw.get)}check(t){return this.dirty(t)&&this.compute(t),O(this,H)[H]}calculate(t){if(O(this,R)[R].has(t))return O(this,R)[R].get(t);let e=!1;O(this,B)[B]&&G(this,t,O(this,B)[B])&&(e=!0);for(let s of O(this,_)[_]())s.calculate(t)&&(e=!0);return O(this,R)[R].set(t,e),e}}function*I(){yield*this.argDeps,this.inputDeps&&(yield*this.inputDeps.values())}function G(t,e,s){let{args:r,binding:i,raw:n,inputProps:l}=t;if(t.inputDeps)for(let[s,r]of t.inputDeps){let t=r.check(e);r.raw instanceof U&&Array.isArray(t)&&(t=t[0]),l.set(s,t)}r.length=0;for(let s of t.argDeps)if(s.raw instanceof U){let t=s.check(e);t&&r.push(...t)}else r.push(s.check(e));return s.call(n,r,i,l,e)}function J(t,e){return t.rule.specificity===e.rule.specificity?t.sourceOrder<e.sourceOrder:t.rule.specificity<e.rule.specificity}var Q=/*#__PURE__*/x("find"),X=/*#__PURE__*/x("firstMatch");class Y{constructor(t,e,s){Object.defineProperty(this,X,{value:tt}),Object.defineProperty(this,Q,{value:Z}),this.root=e,this.propertyName=t,this.rootElement=e.rootElement,this.element=s,this.declarations=[],this.computedValues=new Map,this.compute=null,this.value=T,this.initial=T}add(t){return this.addTemplate(t,t.template)}push(t){!function(t,e,s){if(0===t.length)return t.push(e),0;let r=0,i=t.length-1,n=0;for(;r<=i;)n=r+(i-r>>1),s(t[n],e)?r=n+1:i=n-1;s(t[n],e)&&n++,t.splice(n,0,e)}(this.declarations,t,J)}addTemplate(t,e,s){let r=new z(e,this,s);return this.computedValues.set(t,r),r}dirty(t){if(this.value===T)return!0;{let e=this.compute;return this.compute=O(this,Q)[Q](),e!==this.compute||!!e&&e.dirty(t)}}update(t){return null===this.compute&&(this.compute=O(this,Q)[Q]()),this.value=null===this.compute?this.initial:this.compute.check(t),this.value}getList(){var t;return(null==(t=this.compute)?void 0:t.listValue())||[]}hasValue(){return this.value!==T}*walk(){let t,e=this.declarations,s=e.length;for(;s>0;)s--,t=e[s],this.matches(t.rule.selector)&&(yield t)}matches(t){let e=this.element;return":root"===t||"matches"in e&&e.matches(t)}}function Z(){let t=O(this,X)[X]();return t?this.computedValues.get(t):null}function tt(){for(let t of this.walk())return t}const et={for(t){let e=this.map;return e.get(t)||e.set(t,this(t))&&e.get(t)},is(t){return Object.prototype.isPrototypeOf.call(this.base,t)}};let st=()=>{function t(e){return Object.create(t.base,{name:{enumerable:!1,writable:!1,configurable:!1,value:e}})}return t.base=Object.create(null),t.map=new Map,Object.assign(t,et),t};const rt=st(),it=st(),nt=it("revert-sheet"),lt=it("all");class at extends Array{constructor(t){super(t),this.fill(T),this.numberOfValues=0}empty(t){return this[t]===T}full(){return this.numberOfValues===this.length}set(t,e){this[t]=e,this.numberOfValues++}}function ot(t,e=[]){let s={Value:t,deps:e,inputProperties:null};if(t.inputProperties){let e=new Map;for(let s of t.inputProperties)e.set(s,ot(U,[ot(L(s))]));s.inputProperties=e}return s}var ht=/*#__PURE__*/x("setInitials"),ut=/*#__PURE__*/x("bookkeep"),ct=/*#__PURE__*/x("appendToValues");class ft extends Y{constructor(t,...e){var s;super(...e),Object.defineProperty(this,ct,{value:mt}),Object.defineProperty(this,ut,{value:pt}),Object.defineProperty(this,ht,{value:dt}),this.defn=t,this.numberOfValues=(null==(s=t.longhand)?void 0:s.length)||2,this.numberOfValuesWithKey=this.numberOfValues+(4&t.feat?1:0),this.active=new Set,this.initial=new Map,this.oldValues=16&t.feat?new Map:null}add(t){this.push(t);let e=t.propertyName;switch(t.flags){case b.multi|b.shorthand:case b.multi|b.behavior:case b.multi|b.shorthand|b.label:case b.multi:case b.shorthand:return this.addTemplate(t,t.template);case b.longhand:case b.longhand|b.label:return this.addTemplate(t,t.template,m[e].index);default:throw new Error("Unknown property type")}}*calculate(t){let e,s=this.declarations,r=new Set(this.active),i=new Set,n=new Map,l=function(t,e){let s;return n.has(t)?s=n.get(t):(s=new at(e),n.set(t,s)),s},a=new Set,o=s.length;t:for(;o>0;)if(o--,e=s[o],this.matches(e.rule.selector)){let s=this.computedValues.get(e),o=s.dirty(t),u=s.check(t);switch(e.flags){case b.multi|b.shorthand:case b.multi:for(let t of u){let e=t[0],s=rt.is(e)?1:0;if(t[1]===nt){if(e===lt){for(let t of this.active)i.add(t);break}i.add(e);break}if(i.has(e)||void 0===e)break;if(1===t.length)break;O(this,ut)[ut](r,e),o&&a.add(e);let n=l(e,this.numberOfValuesWithKey);for(let e=0;s<t.length;e++,s++)n.empty(e)&&n.set(e,t[s])}break;case b.multi|b.shorthand|b.label:for(let t of u){let e=t[0],s=rt.is(e);s?t=t.slice(1):e=rt.for("corset.default."+e),O(this,ut)[ut](r,e,s?t[1]:t[0]);let i=l(e,this.numberOfValues);for(let e=0;e<t.length;e++)i.empty(e)&&i.set(e,t[e]);o&&a.add(e)}break;case b.multi|b.behavior:for(let[t]of u){var h;let e=t[0];O(this,ut)[ut](r,e);let s=O(this,ct)[ct](e,t);yield[s,o],null==(h=this.oldValues)||h.set(e,t)}break t;case b.longhand:{let t=4&this.defn.feat,e=t?u[0]:null,i=t?u[1]:u[0],h=s.index+(t?1:0);O(this,ut)[ut](r,e);let c=l(e,this.numberOfValuesWithKey);if(t&&c.empty(0)&&c.set(0,u[0]),c.empty(h)&&c.set(h,i),o&&a.add(e),c.full()){this.oldValues&&this.oldValues.set(e,Array.from(c)),yield[c,o||a.has(e)],n.delete(e),a.delete(e);break}break}case b.longhand|b.label:{let t=rt.is(u[0]),e=t?u[0]:rt.for("corset.default."+u[0]),i=u[1];O(this,ut)[ut](r,e,u[0]);let n=l(e,this.numberOfValues);!t&&n.empty(0)&&n.set(0,u[0]),n.empty(s.index)&&n.set(s.index,i),o&&a.add(e);break}case b.shorthand:O(this,ut)[ut](r,null),yield[O(this,ct)[ct](null,u,!1),o];break;default:throw new Error("This is not supported")}}for(let[t,e]of n){if(!a.has(t))continue;let s=this.numberOfValues,r=4&this.defn.feat,i=r?1:0;for(;i<s;)e.empty(i)&&(e[i]=this.defn.defaults[i-(r?1:0)]),i++;if(this.oldValues){let s=this.oldValues.get(t);this.oldValues.set(t,e.slice()),s&&e.push(...s)}yield[e,!0]}for(let t of r){let e=this.initial.get(t)||[],s=4&this.defn.feat&&!rt.is(t)?[t,...e]:Array.from(e),r=O(this,ct)[ct](t,s);yield[r,!0],this.active.delete(t)}}*values(t){for(let[e]of this.calculate(t))yield e}*current(){if(this.oldValues)for(let[t,e]of this.oldValues){let s=t?[t]:[];yield s.concat(e)}}*changes(t){for(let[e,s]of this.calculate(t))s&&(yield e)}}function dt(t,e){if(!this.initial.has(t)){let s=[];if(this.defn.longhand){let r=0,i=this.defn.longhand.length;for(;r<i;)s[r]=m[this.defn.longhand[r]].read(this.element,t),r++;e&&(s[0]=e)}else 32&this.defn.feat?s=[null,null]:this.defn.read&&(s[0]=this.defn.read(this.element,t));this.initial.set(t,Object.freeze(s))}}function pt(t,e,s){t.delete(e),null!==e&&O(this,ht)[ht](e,s),this.active.add(e)}function mt(t,e,s=!0){if(e.length===this.numberOfValuesWithKey&&null===this.oldValues)return e;let r=[],i=rt.is(t);"string"==typeof t&&r.push(t);let n=r.length+e.length,l=s?1:0,a=i?this.numberOfValues:this.numberOfValuesWithKey;for(;n<a;)r.push(this.defn.defaults[n-l]),n++;if(this.oldValues&&this.oldValues.has(t)){let e=this.oldValues.get(t);r.push(...e)}return e.concat(r)}class gt extends Y{constructor(t,e,...s){super(e,...s),this.defn=t,this.initial=this.defn.read(this.element)}}var bt=/*#__PURE__*/x("getOrAddBinding");class vt{constructor(t,e){Object.defineProperty(this,bt,{value:yt}),this.root=t,this.element=e,this.seen=new WeakSet,this.attachTemplate=null,this.behavior=null,this.text=null,this.data=null,this.each=null,this.event=null,this.attr=null,this.classToggle=null,this.mount=null,this.prop=null,this.storeRoot=null,this.storeSet=null,this.custom=new Map,this.flags=0}add(t){if(this.seen.has(t))return;this.seen.add(t);let e=t.propertyName;if(e in m){let s,r=m[e];if(this.flags|=r.flag,8&r.feat||"longhand"in r?s=r:"shorthand"in r&&(s=m[r.shorthand]),s)this[s.prop]||(this[s.prop]=new ft(s,e,this.root,this.element)),this[s.prop].add(t);else{let s=O(this,bt)[bt](e,r);s.push(t),s.add(t)}}else if(e.startsWith("--")){let s=O(this,bt)[bt](e,null);s.push(t),s.add(t),this.flags|=8,this.custom.set(e,s)}}}function yt(t,e){let s=e?e.prop:t;if(!e){if(!this.custom.has(t)){let e=new Y(t,this.root,this.element);this.custom.set(t,e)}return this.custom.get(t)}if(!this[s]){let r=new gt(e,t,this.root,this.element);this[s]=r}return this[s]}const wt=Symbol.for("corset.each"),kt=Symbol.for("corset.item"),xt=Symbol.for("corset.index");class Ot{constructor(t,e,s){var r;this.keyMap=new Map,this.host=t,this.template=e,this.key=s,this.keyFn=this.key?this.keyKeyed:this.keyNonKeyed;let i=null!=(r=this.host.ownerDocument)?r:document;this.start=i.createComment("each(items)"),this.end=i.createComment("end each(items)"),this.host.append(this.start),this.start.after(this.end),this.frags=[],this.keys=[]}set(t){return this.updateValues(t)}setData(t,e,s){for(let r of t.nodes)if("dataset"in r){let t=r;S(t,wt,"item",kt,"corsetScope",e),S(t,wt,"index",xt,"corsetScope",s)}}render(t,e){let s=(this.host.ownerDocument||document).importNode(this.template.content,!0);return s.nodes=Array.from(s.childNodes),s.data={item:e,index:t},this.setData(s,e,t),s}keyNonKeyed(t,e){return e}keyKeyed(t){return t[this.key]}refrag(t){return!t.firstChild&&t.nodes&&t.append(...t.nodes),t}append(t,e){(e?e.nodes[e.nodes.length-1]:this.start).after(this.refrag(t))}before(t,e){(e?e.nodes[0]:this.end).before(this.refrag(t))}remove(t){this.clear(t.nodes[0],t.nodes[t.nodes.length-1].nextSibling)}clear(t=this.start.nextSibling,e=this.end){let s,r=t;for(;r!==e;)s=r.nextSibling,r.remove(),r=s}updateFrag(t,e,s){return t.data.item===s&&t.data.index===e||this.setData(t,s,e),t}updateValues(t=[]){let e=!1,s=this.frags,r=[],i=this.keys,n=new Map,l=[];for(let e=0,s=t.length;e<s;e++){let s=this.keyFn(t[e],e);n.set(s,t[e]),l[e]=s}let a=0,o=t.length-1,h=0,u=s.length-1;for(;h<=u&&a<=o;)if(null===s[h])h++;else if(null===s[u])u--;else if(i[h]===l[a])r[a]=this.updateFrag(s[h],a,t[a]),h++,a++;else if(i[u]===l[o])r[o]=this.updateFrag(s[u],a,t[o]),u--,o--;else if(i[h]===l[o])r[o]=this.updateFrag(s[h],a,t[o]),this.before(s[h],r[o+1]),h++,o--;else if(i[u]===l[a])r[a]=this.updateFrag(s[u],a,t[a]),this.before(s[u],s[h]),u--,a++;else if(n.has(i[h]))if(n.has(i[u])){let e=t[a],i=this.keyMap.get(this.keyFn(e,a));void 0===i?(i=this.render(a,e),this.keyMap.set(this.keyFn(e,a),i)):(i=this.updateFrag(i,a,e),s[s.indexOf(i)]=null),r[a]=i,this.append(i,s[a-1]),a++}else this.remove(s[u]),u--;else this.remove(s[h]),h++;for(;a<=o;){let s=this.render(a,t[a]);this.keyMap.set(this.keyFn(s.data.item,a),s),this.append(s,r[a-1]),r[a++]=s,e=!0}for(;h<=u;){let t=s[h];this.keyMap.delete(this.keyFn(t.data.item,h)),h++,this.remove(t),e=!0}return this.keys=l,this.frags=r,e}}let Mt=new Map;function St(t,e,...s){let r=e.call(t.behavior,...s);return t.update(),r}function Vt(t){this.element=t.rootElement,this.rebind=t.update.bind(t),this.stores=new Map}class Et{constructor(t,e,s){this.rootElement=t,this.props=s||null,this.context=new Vt(this),this.behavior=new e(s,this.context),this.bindings=null,this.callbacks=new WeakMap,this.parent=null}getCallback(t){if(this.callbacks.has(t))return this.callbacks.get(t);let e=St.bind(null,this,t);return this.callbacks.set(t,e),e}update(){return this.bindings=this.behavior.bind(this.props,this.context),this.bindings.update(this)}unmount(){this.bindings&&this.bindings.unmount(this)}}function Pt(t,e,s){let r=new Et(t,e,s);return r.update(),r}function jt(t,e){Mt.set(t,e)}const At=new WeakMap,Dt=new WeakMap,Tt=Symbol.for("corset.props"),Lt=Symbol.for("corset.stores");function Ct(t,e,s,r){let i=!1,n=e.flags;if(1024&n){if(!(t instanceof HTMLElement))throw new Error("Stores cannot be used on non-HTML elements.");let n=e.storeRoot;if(n.dirty(r)){let e=n.value,u=n.update(r);if(u){var l,a;let e=new j(s);S(t,Lt,u,Symbol.for(A(u)),"corsetStores",e),null==(l=s.mount)||null==(a=l.context)||a.stores.set(u,e)}else{var o,h;V(t,Lt,e,Symbol.for(A(e)),"corsetStores"),null==(o=s.mount)||null==(h=o.context)||h.stores.delete(e)}i=!0}}if(8&n){if(!(t instanceof HTMLElement))throw new Error("Custom properties cannot be used on non-HTML elements.");for(let[s,i]of e.custom)if(i.dirty(r)){i.update(r);let e=i.getList();e.length?S(t,Tt,s,Symbol.for(s),"corsetProps",{value:e,compute:i.compute}):V(t,Tt,s,Symbol.for(s),"corsetProps")}}if(2048&n){let s=e.storeSet;if(s.dirty(r)){let e=s.update(r);if(e){let[s,r,i]=e,n=M(t,D(s),A(s));null==n||n.set(r,i)}i=!0}}if(2&e.flags&&"classList"in t){let s=e.classToggle;for(let[e,n]of s.changes(r))t.classList.toggle(e,n),i=!0}if(16&n){let s=e.each;for(let[e,n,l]of s.values(r)){let s;At.has(t)&&(s=At.get(t)),s&&s.template===n||(s=new Ot(t,n,l),At.set(t,s)),s.set(e)&&(i=!0)}}t:if(256&n){let s=e.attachTemplate;if(s.dirty(r)){let e=s.update(r);if(Array.isArray(e)&&(e=e[0]),void 0===e)break t;let n=(t.ownerDocument||document).importNode(e.content,!0);t.replaceChildren(n),i=!0,r.flags|=256}}if(64&n&&t instanceof Element)for(let[s,n,l]of e.attr.changes(r))l?t.setAttribute(s,n):t.removeAttribute(s),i=!0;if(128&n){let s=e.data;for(let[e,n]of s.changes(r))void 0===n?delete t.dataset[e]:t.dataset[e]=n,i=!0}t:if(1&n){let s=e.text;if(s.dirty(r)){let e=s.update(r);if(256&r.flags)break t;Array.isArray(e)&&(e=e.join("")),t.textContent=e}}if(32&n){let s=e.prop;for(let[e,i]of s.changes(r))t[e]=i}if(512&n){let n=e.behavior;for(let[e,l,a]of n.changes(r)){let r,n=void 0!==a,o=n&&a===e;if(Dt.has(t)?r=Dt.get(t):(r=new Map,Dt.set(t,r)),n||o){let t=r.get(a);o?t.update()&&(i=!0):t.unmount()}if(!o&&null!==e){let n=new Et(t,e,l);n.parent=s.mount,n.update()&&(i=!0),r.set(e,n)}}}if(4&n){let i=e.event;for(let[e,n,l,a,o,h,u,c,f]of i.changes(r))void 0!==c&&t.removeEventListener(e,s.getCallback(c),f),n&&t.addEventListener(e,s.getCallback(n),{capture:l,once:a,passive:o,signal:h})}return i}function Wt(t,e,s){let r=!1;for(let[i,n]of t)Ct(i,n,e,s)&&(r=!0);return r}function Ft(t,e,s){let r=e.flags;if(512&r){let s=e.behavior,r=Dt.get(t);for(let[t]of s.current()){var i;null==(i=r.get(t))||i.unmount()}}if(4&r){let r=e.event;for(let[e,i,n]of r.current())t.removeEventListener(i,s.getCallback(n))}}class Nt{constructor(t){this.values=t,this.selectors=!0,this.flags=0}}const Ut=t=>t;class $t{constructor(t,e){this.mount=t instanceof Et?t:null,this.rootElement=this.mount?this.mount.rootElement:t,this.rules=e.rules,this.bindingMap=new Map,this.getCallback=this.mount?this.mount.getCallback.bind(this.mount):Ut,this.values=null,this.queue=0}update(t=this.values){if(this.values=t,this.queue++,this.queue>1)return!1;let e=!0,s=!1;for(;e;){let r=new Nt(t);this.collect(),e=Wt(this.bindingMap,this,r),e&&(s=!0)}var r,i;return s&&(null==(r=this.mount)||null==(i=r.parent)||i.update()),this.queue=0,s}collect(){let t=this.rootElement;for(let e of this.rules)for(let s of e.querySelectorAll(t)){let t;this.bindingMap.has(s)?t=this.bindingMap.get(s):(t=new vt(this,s),this.bindingMap.set(s,t));for(let s of e.declarations)t.add(s)}}unmount(){!function(t,e){for(let[s,r]of t)Ft(s,r,e)}(this.bindingMap,this)}}class qt{constructor(){this.rules=[]}addRule(t){this.rules.push(t)}}class Kt{constructor(t,e){this.roots=new WeakMap,this.sheet=t,this.values=e}update(t){let e;return this.roots.has(t)?e=this.roots.get(t):(e=new $t(t,this.sheet),this.roots.set(t,e)),e.update(this.values)}unmount(t){this.roots.has(t)&&this.roots.get(t).unmount()}}const Ht={};function Rt(){return Object.create(Ht,{fns:{enumerable:!0,value:new Map}})}const Bt=Rt(),_t=Rt();function zt(t,e){this.fns.set(t,e)}function It(t,e){if(!t.startsWith("--"))throw new Error("Custom functions must start with --");let s=this;s&&Ht.isPrototypeOf(s)||(s=Bt),zt.call(s,t,e)}zt.call(Bt,"get",class{constructor(){this.value=T}check([t,e]){if("object"==typeof t&&"function"!=typeof e){let s=E in t?t[E](e):t[e];if(s!==this.value)return this.value=s,!0}return!1}call([t,e]){return"function"==typeof e?e(t):E in t?t[E](e):t[e]}}),zt.call(Bt,"select",class{call([t],e,{rootElement:s}){return s.querySelector(t)}});class Gt{constructor(t,e){this.dataSelector=`[data-corset-scope~=${t}]`,this.propName=e,this.value=T}check([],t,{element:e},s){let r=!1;if(s.selectors&&(r=!0),r){let t=M(e,this.dataSelector,this.propName);if(t!==this.value)return this.value=t,!0}return!1}call(){return this.value}}zt.call(Bt,"item",class extends Gt{constructor(){super("item","corset.item")}}),zt.call(Bt,"index",class extends Gt{constructor(){super("index","corset.index")}}),zt.call(Bt,"store-get",class{constructor(){this.value=void 0}check([t,e],s,{element:r},i){if(i.selectors){let s=M(r,D(t),A(t));if((null==s?void 0:s.get(e))!==this.value)return this.value=null==s?void 0:s.get(e),!0}return!1}call(){return this.value}}),zt.call(Bt,"store",class{constructor(){this.map=void 0}check([t],e,{element:s},r){if(r.selectors){let e=M(s,D(t),A(t));if(e!==this.map)return this.map=e,!0}return!1}call(){return this.map}}),zt.call(Bt,"bind",class{call([t,...e]){function s(...s){return t.call(this,...e,...s)}return Object.defineProperty(s,"name",{value:"bound "+t.name}),s}}),zt.call(Bt,"data",class{call([t],e,{element:s}){if(!(s instanceof HTMLElement))throw new Error("data() only works on HTMLElements.");return s.dataset[t]}}),zt.call(Bt,"mount",class{constructor(){this.compute=null,this.Behavior=null,this.value=null}check([t],e,s,r){let i=t;if("string"==typeof t){let e=t;if(!Mt.has(e))throw new Error(`Unregistered behavior ${e}`);i=Mt.get(e)}if(i!==this.Behavior){let t=L(i);t.inputProperties=i.inputProperties;let e=ot(t);return this.Behavior=i,this.compute=new z(e,Object.getPrototypeOf(s)),this.compute.check(r),this.value=Object.freeze([i,this.compute.inputProps]),!0}if(this.compute){let t=this.compute.dirty(r);return this.compute.check(r),t}return!1}call([]){return this.value}});let Jt=new Map([[3,nt],[4,lt]]);function Qt(t){let e=t>>2,s=e+3,r=l[e];switch(r){case 1:return ot(C,[ot(L(l[s]))]);case 2:case 3:return ot(L(p(l[s],l[s+1])));case 4:{let t,e=p(l[s],l[s+1]);switch(!0){case"var"===e:t=U;break;case Bt.fns.has(e):{let s=Bt.fns.get(e);t=q(s);break}case _t.fns.has(e):{let s=_t.fns.get(e);t=q(s);break}case e.startsWith("--"):{let s=function(t){class e{call(e,s,r){let i=s.get(t);if("function"!=typeof i)throw new Error(`Unable to find the custom function ${t}`);return i.apply(r,e)}}return e.inputProperties=[t],It.call(_t,t,e),e}(e);t=q(s);break}default:throw new Error(`Unknown function ${e}`)}let r=[],i=l[s+3];for(;i;)r.push(Qt(i)),i=l[1+(i>>2)];return ot(t,r)}case 6:return ot(L(Boolean(l[s])));case 7:return ot(L(rt.for(p(l[s],l[s+1]))));case 8:return ot(L(Jt.get(l[s])));default:throw new Error(`Unknown value type [${r}]`)}}const Xt=new WeakMap;function Yt(t,...s){let c=function(t,s){if(Xt.has(t))return Xt.get(t);let c=function(t,s){let c,b=new qt,v=0;for(function(t,s){let r=s.map(t=>"ins()"),c=String.raw(t,...r);const f=u.encode(c);d=f.byteLength;const p=i(d);n.set(f,p),h=n.subarray(p);const m=e();a=n.subarray(m),o=l.subarray(m>>2)}(t,s);r(d);)switch(a[0]){case 1:c=new w(p(o[1],o[2])),b.addRule(c);break;case 2:{let t=f(h,o[1],o[2]),e=o[4],s=o[3],r=m[t],i=[],n=i;for(;e;)5===l[e>>2]?(i===n&&(i=[]),i.push(ot(W,n)),n=[]):n.push(Qt(e)),e=l[1+(e>>2)];let a,u=i!==n;switch(8&(null==r?void 0:r.feat)&&!u&&(i=[]),(u||8&(null==r?void 0:r.feat))&&i.push(ot(W,n)),!0){case!!(8&(null==r?void 0:r.feat)):a=ot(F,i);break;case!!(2&(null==r?void 0:r.feat))||s>1:a=ot(u?F:W,i);break;default:a=i[0]}let d=new g(c,t,v++,a);d.init(),c.addDeclaration(d);break}case 4:{let t=o[1];switch(t){case 1:case 2:{let e=o[2];if(39===e)throw new SyntaxError("Saw the a single quote character ('). Use double quotes (\") for strings.");throw new SyntaxError(`Unexpected token "${String.fromCharCode(e)}" found. Error code ${t}.`)}default:throw new Error(`Unknown Parse error occurred. Error code [${t}]`)}}}return b}(t,s),b=new Kt(c,s);return Xt.set(t,b),b}(t,s);return c.values=s,c}export{Yt as default,Pt as mount,jt as registerBehavior,It as registerCustomFunction,Yt as sheet};
//# sourceMappingURL=main.js.map
