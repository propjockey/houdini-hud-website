const t=(await WebAssembly.instantiateStreaming(fetch(new URL("./main.wasm",import.meta.url).toString()))).instance.exports,e=t.get_tag,s=t.memory,i=t.parse,r=t.reset,n=new Uint8Array(s.buffer),a=new Uint32Array(s.buffer);let l,o,h;const u=new TextEncoder,c=new TextDecoder,f=(t,e,s)=>c.decode(t.slice(e,s));let d;const p=(t,e)=>f(h,t,e),m={"attach-template":{flag:256,feat:0,prop:"attachTemplate",read(t){let e=(t.ownerDocument||document).createElement("template");return e.content.append(...Array.from(t.childNodes)),e}},attr:{flag:64,feat:13,prop:"attr",longhand:["attr-value","attr-toggle"],defaults:["",!0]},"attr-value":{flag:64,feat:2,shorthand:"attr",index:0,default:"",read:(t,e)=>"getAttribute"in t&&t.getAttribute(e)},"attr-toggle":{flag:64,feat:2,shorthand:"attr",index:1,default:!0,read:(t,e)=>"hasAttribute"in t&&t.hasAttribute(e)},"class-toggle":{flag:2,feat:12,prop:"classToggle",read:(t,e)=>"classList"in t&&t.classList.contains(e)},data:{flag:128,feat:12,prop:"data",read(t,e){if(!("dataset"in t))throw new Error("data can only be used on HTMLElements");return t.dataset[e]}},each:{flag:16,feat:1,prop:"each",longhand:["each-items","each-template","each-key"],defaults:[[],{},null]},"each-items":{flag:16,feat:2,shorthand:"each",index:0,default:[],read:()=>null},"each-template":{flag:16,feat:2,shorthand:"each",index:1,default:{},read:()=>null},"each-key":{flag:16,feat:2,shorthand:"each",index:2,default:null,read:()=>null},event:{flag:4,feat:93,prop:"event",longhand:["event-type","event-listener","event-capture","event-once","event-passive","event-signal"],defaults:[null,!1,!1,!1,void 0]},"event-type":{flag:4,feat:70,shorthand:"event",index:0,default:null,read:()=>null},"event-listener":{flag:4,feat:66,shorthand:"event",index:1,default:null,read:()=>null},"event-capture":{flag:4,feat:66,shorthand:"event",index:2,default:!1,read:()=>!1},"event-once":{flag:4,feat:66,shorthand:"event",index:3,default:!1,read:()=>!1},"event-passive":{flag:4,feat:66,shorthand:"event",index:4,default:!1,read:()=>!1},"event-signal":{flag:4,feat:66,shorthand:"event",index:5,default:void 0,read:()=>{}},behavior:{flag:512,feat:56,prop:"behavior"},prop:{flag:32,feat:12,prop:"prop",read:(t,e)=>t[e]},text:{flag:1,feat:0,prop:"text",read:t=>t.textContent},"store-root":{flag:1024,feat:0,prop:"storeRoot",read:()=>null},"store-set":{flag:2048,feat:0,prop:"storeSet",read:()=>null}};class g{constructor(t,e,s,i){this.rule=t,this.propertyName=e,this.keyTemplate=null,this.sourceOrder=s,this.template=i,this.flags=0}init(){let t=m[this.propertyName];t&&(8&t.feat&&(this.flags|=v.multi),64&t.feat&&(this.flags|=v.label),2&t.feat?this.flags|=v.longhand:1&t.feat?this.flags|=v.shorthand:32&t.feat&&(this.flags|=v.behavior))}}const v={shorthand:1,longhand:2,multi:4,behavior:8,label:16},b=t=>[t];function y(t){return t.querySelectorAll(this.selector)}class w{constructor(t){this.selector=t,this.declarations=[],this.specificity=0,this.querySelectorAll=":root"===t?b:y}addDeclaration(t){this.declarations.push(t)}}var k=0;function x(t){return"__private_"+k+++"_"+t}function O(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}function M(t,e,s,i){let r=t;do{if(r.hasAttribute(e))return r[Symbol.for(i)];r=t.closest(s)}while(r)}function V(t){return t.replace(/-?-([a-zA-Z])/g,(t,e)=>e.toUpperCase())}function E(t){return"corset"+V(t)}function P(t){return"corsetProp"+V(t)}const S=Symbol.for("corset.getKey");var j=/*#__PURE__*/x("update");class A extends Map{constructor(t,e=!0){super(),Object.defineProperty(this,j,{writable:!0,value:void 0}),this.root=t,O(this,j)[j]=e?this.root.mount?this.root.mount.update.bind(this.root.mount):Function.prototype:this.root.update.bind(this.root)}[S](t){return this.get(t)}set(t,e){return super.set(t,e),O(this,j)[j](),this}}const D=t=>`corset.store.${t}`,T=t=>`data-corset-store-${t}`,L=t=>"corsetStore"+V("-"+t),C=Symbol("corset.noValue"),N=t=>class{get(){return t}};class W{constructor(){this.current=0,this.value=C}check([t],e,s,{values:i}){let r=i[t];return this.value!==r&&(this.value=r,!0)}get(){return this.value}}class F{get(t=[]){return t}}class U extends F{}var $=/*#__PURE__*/x("get");class q{constructor(){Object.defineProperty(this,$,{value:K}),this.current=0,this.compute=C,this.value=null}check(t,e,s,i){let r=!1;if(i.selectors)r=!0;else{if(this.compute!==C){this.compute.dirty(i);let t=this.compute.check(i);return t!==this.value&&(this.value=t,!0)}r=!0}if(r){let s=O(this,$)[$](t,e);if(s)return(s.value!==this.value||s.compute!==this.compute)&&(this.compute=s.compute,this.value=s.value,!0);if(t.length>1){let e=t[1];return!(this.value&&e===this.value[0]||(this.value=[e],0))}}return!1}get(){return this.value}}function K(t,{element:e}){let[s]=t,i="data-corset-prop-"+s.slice(2);return M(e,i,"["+i+"]",s)}const H=t=>{let e=t.prototype;if("object"!=typeof e)throw new Error("Functions must contain a prototype");let s=e.call;class i{constructor(e){this.context=Object.create(e,{createStore:{value:()=>new A(e.root,!1)}}),this.fn=new t}get(t,e,i){return s.call(this.fn,t,i,this.context)}}if(i.inputProperties=t.inputProperties,e.check){let t=e.check;i.prototype.check=function(e,s,i,r){return t.call(this.fn,e,i,this.context,r)}}return i};var R=/*#__PURE__*/x("initial"),B=/*#__PURE__*/x("value"),I=/*#__PURE__*/x("dirty"),_=/*#__PURE__*/x("check"),z=/*#__PURE__*/x("allDeps");class Z{constructor(t,e,s=0){Object.defineProperty(this,z,{value:G}),Object.defineProperty(this,R,{writable:!0,value:!0}),Object.defineProperty(this,B,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:new WeakMap}),Object.defineProperty(this,_,{writable:!0,value:void 0}),this.binding=e,this.index=s,this.args=[],this.argDeps=[],this.inputDeps=null,this.inputProps=null,this.raw=function(t,e){let s=new e.Value(t.binding);for(let s of e.deps)t.argDeps.push(new Z(s,t.binding));let i=e.inputProperties;if(i){t.inputProps=new Map,t.inputDeps=new Map;for(let[e,s]of i)t.inputDeps.set(e,new Z(s,t.binding))}return s}(this,t),this.listValue=this.raw instanceof F?()=>O(this,B)[B]:()=>[O(this,B)[B]],O(this,B)[B]=null,O(this,_)[_]=this.raw.check}set(t,e,s){let i=this.argDeps;i[t]!==e&&O(this,I)[I].set(s,!0),i[t]=e}dirty(t){return O(this,R)[R]&&(this.calculate(t),O(this,I)[I].set(t,!0),O(this,R)[R]=!1),O(this,I)[I].has(t)||this.calculate(t),O(this,I)[I].get(t)}compute(t){O(this,B)[B]=J(this,t,this.raw.get)}check(t){return this.dirty(t)&&this.compute(t),O(this,B)[B]}calculate(t){if(O(this,I)[I].has(t))return O(this,I)[I].get(t);let e=!1;O(this,_)[_]&&J(this,t,O(this,_)[_])&&(e=!0);for(let s of O(this,z)[z]())s.calculate(t)&&(e=!0);return O(this,I)[I].set(t,e),e}}function*G(){yield*this.argDeps,this.inputDeps&&(yield*this.inputDeps.values())}function J(t,e,s){let{args:i,binding:r,raw:n,inputProps:a}=t;if(t.inputDeps)for(let[s,i]of t.inputDeps){let t=i.check(e);i.raw instanceof q&&Array.isArray(t)&&(t=t[0]),a.set(s,t)}i.length=0;for(let s of t.argDeps)if(s.raw instanceof q){let t=s.check(e);t&&i.push(...t)}else i.push(s.check(e));return s.call(n,i,r,a,e)}function Q(t,e){return t.rule.specificity===e.rule.specificity?t.sourceOrder<e.sourceOrder:t.rule.specificity<e.rule.specificity}var X=/*#__PURE__*/x("find"),Y=/*#__PURE__*/x("firstMatch");class tt{constructor(t,e,s){Object.defineProperty(this,Y,{value:st}),Object.defineProperty(this,X,{value:et}),this.root=e,this.propertyName=t,this.rootElement=e.rootElement,this.element=s,this.declarations=[],this.computedValues=new Map,this.compute=null,this.value=C,this.initial=C}add(t){return this.addTemplate(t,t.template)}push(t){!function(t,e,s){if(0===t.length)return t.push(e),0;let i=0,r=t.length-1,n=0;for(;i<=r;)n=i+(r-i>>1),s(t[n],e)?i=n+1:r=n-1;s(t[n],e)&&n++,t.splice(n,0,e)}(this.declarations,t,Q)}addTemplate(t,e,s){let i=new Z(e,this,s);return this.computedValues.set(t,i),i}dirty(t){if(this.value===C)return!0;{let e=this.compute;return this.compute=O(this,X)[X](),e!==this.compute||!!e&&e.dirty(t)}}update(t){return null===this.compute&&(this.compute=O(this,X)[X]()),this.value=null===this.compute?this.initial:this.compute.check(t),this.value}getList(){var t;return(null==(t=this.compute)?void 0:t.listValue())||[]}hasValue(){return this.value!==C}*walk(){let t,e=this.declarations,s=e.length;for(;s>0;)s--,t=e[s],this.matches(t.rule.selector)&&(yield t)}matches(t){let e=this.element;return":root"===t||"matches"in e&&e.matches(t)}}function et(){let t=O(this,Y)[Y]();return t?this.computedValues.get(t):null}function st(){for(let t of this.walk())return t}const it={for(t){let e=this.map;return e.get(t)||e.set(t,this(t))&&e.get(t)},is(t){return Object.prototype.isPrototypeOf.call(this.base,t)}};let rt=()=>{function t(e){return Object.create(t.base,{name:{enumerable:!1,writable:!1,configurable:!1,value:e}})}return t.base=Object.create(null),t.map=new Map,Object.assign(t,it),t};const nt=rt(),at=rt(),lt=at("revert-sheet"),ot=at("all");class ht extends Array{constructor(t){super(t),this.fill(C),this.numberOfValues=0}empty(t){return this[t]===C}full(){return this.numberOfValues===this.length}set(t,e){this[t]=e,this.numberOfValues++}}function ut(t,e=[]){let s={Value:t,deps:e,inputProperties:null};if(t.inputProperties){let e=new Map;for(let s of t.inputProperties)e.set(s,ut(q,[ut(N(s))]));s.inputProperties=e}return s}var ct=/*#__PURE__*/x("setInitials"),ft=/*#__PURE__*/x("bookkeep"),dt=/*#__PURE__*/x("appendToValues");class pt extends tt{constructor(t,...e){var s;super(...e),Object.defineProperty(this,dt,{value:vt}),Object.defineProperty(this,ft,{value:gt}),Object.defineProperty(this,ct,{value:mt}),this.defn=t,this.numberOfValues=(null==(s=t.longhand)?void 0:s.length)||2,this.numberOfValuesWithKey=this.numberOfValues+(4&t.feat?1:0),this.active=new Set,this.initial=new Map,this.oldValues=16&t.feat?new Map:null}add(t){this.push(t);let e=t.propertyName;switch(t.flags){case v.multi|v.shorthand:case v.multi|v.behavior:case v.multi|v.shorthand|v.label:case v.multi:case v.shorthand:return this.addTemplate(t,t.template);case v.longhand:case v.longhand|v.label:return this.addTemplate(t,t.template,m[e].index);default:throw new Error("Unknown property type")}}*calculate(t){let e,s=this.declarations,i=new Set(this.active),r=new Set,n=new Map,a=function(t,e){let s;return n.has(t)?s=n.get(t):(s=new ht(e),n.set(t,s)),s},l=new Set,o=s.length;t:for(;o>0;)if(o--,e=s[o],this.matches(e.rule.selector)){let s=this.computedValues.get(e),o=s.dirty(t),u=s.check(t);switch(e.flags){case v.multi|v.shorthand:case v.multi:for(let t of u){let e=t[0],s=nt.is(e)?1:0;if(t[1]===lt){if(e===ot){for(let t of this.active)r.add(t);break}r.add(e);break}if(r.has(e)||void 0===e)break;if(1===t.length)break;O(this,ft)[ft](i,e),o&&l.add(e);let n=a(e,this.numberOfValuesWithKey);for(let e=0;s<t.length;e++,s++)n.empty(e)&&n.set(e,t[s])}break;case v.multi|v.shorthand|v.label:for(let t of u){let e=t[0],s=nt.is(e);s?t=t.slice(1):e=nt.for("corset.default."+e),O(this,ft)[ft](i,e,s?t[1]:t[0]);let r=a(e,this.numberOfValues);for(let e=0;e<t.length;e++)r.empty(e)&&r.set(e,t[e]);o&&l.add(e)}break;case v.multi|v.behavior:for(let[t]of u){var h;let e=t[0];O(this,ft)[ft](i,e);let s=O(this,dt)[dt](e,t);yield[s,o],null==(h=this.oldValues)||h.set(e,t)}break t;case v.longhand:{let t=4&this.defn.feat,e=t?u[0]:null,r=t?u[1]:u[0],h=s.index+(t?1:0);O(this,ft)[ft](i,e);let c=a(e,this.numberOfValuesWithKey);if(t&&c.empty(0)&&c.set(0,u[0]),c.empty(h)&&c.set(h,r),o&&l.add(e),c.full()){this.oldValues&&this.oldValues.set(e,Array.from(c)),yield[c,o||l.has(e)],n.delete(e),l.delete(e);break}break}case v.longhand|v.label:{let t=nt.is(u[0]),e=t?u[0]:nt.for("corset.default."+u[0]),r=u[1];O(this,ft)[ft](i,e,u[0]);let n=a(e,this.numberOfValues);!t&&n.empty(0)&&n.set(0,u[0]),n.empty(s.index)&&n.set(s.index,r),o&&l.add(e);break}case v.shorthand:O(this,ft)[ft](i,null),yield[O(this,dt)[dt](null,u,!1),o];break;default:throw new Error("This is not supported")}}for(let[t,e]of n){if(!l.has(t))continue;let s=this.numberOfValues,i=4&this.defn.feat,r=i?1:0;for(;r<s;)e.empty(r)&&(e[r]=this.defn.defaults[r-(i?1:0)]),r++;if(this.oldValues){let s=this.oldValues.get(t);this.oldValues.set(t,e.slice()),s&&e.push(...s)}yield[e,!0]}for(let t of i){let e=this.initial.get(t)||[],s=4&this.defn.feat&&!nt.is(t)?[t,...e]:Array.from(e),i=O(this,dt)[dt](t,s);yield[i,!0],this.active.delete(t)}}*values(t){for(let[e]of this.calculate(t))yield e}*current(){if(this.oldValues)for(let[t,e]of this.oldValues){let s=t?[t]:[];yield s.concat(e)}}*changes(t){for(let[e,s]of this.calculate(t))s&&(yield e)}}function mt(t,e){if(!this.initial.has(t)){let s=[];if(this.defn.longhand){let i=0,r=this.defn.longhand.length;for(;i<r;)s[i]=m[this.defn.longhand[i]].read(this.element,t),i++;e&&(s[0]=e)}else 32&this.defn.feat?s=[null,null]:this.defn.read&&(s[0]=this.defn.read(this.element,t));this.initial.set(t,Object.freeze(s))}}function gt(t,e,s){t.delete(e),null!==e&&O(this,ct)[ct](e,s),this.active.add(e)}function vt(t,e,s=!0){if(e.length===this.numberOfValuesWithKey&&null===this.oldValues)return e;let i=[],r=nt.is(t);"string"==typeof t&&i.push(t);let n=i.length+e.length,a=s?1:0,l=r?this.numberOfValues:this.numberOfValuesWithKey;for(;n<l;)i.push(this.defn.defaults[n-a]),n++;if(this.oldValues&&this.oldValues.has(t)){let e=this.oldValues.get(t);i.push(...e)}return e.concat(i)}class bt extends tt{constructor(t,e,...s){super(e,...s),this.defn=t,this.initial=this.defn.read(this.element)}}var yt=/*#__PURE__*/x("getOrAddBinding");class wt{constructor(t,e){Object.defineProperty(this,yt,{value:kt}),this.root=t,this.element=e,this.seen=new WeakSet,this.attachTemplate=null,this.behavior=null,this.text=null,this.data=null,this.each=null,this.event=null,this.attr=null,this.classToggle=null,this.mount=null,this.prop=null,this.storeRoot=null,this.storeSet=null,this.custom=new Map,this.flags=0}add(t){if(this.seen.has(t))return;this.seen.add(t);let e=t.propertyName;if(e in m){let s,i=m[e];if(this.flags|=i.flag,8&i.feat||"longhand"in i?s=i:"shorthand"in i&&(s=m[i.shorthand]),s)this[s.prop]||(this[s.prop]=new pt(s,e,this.root,this.element)),this[s.prop].add(t);else{let s=O(this,yt)[yt](e,i);s.push(t),s.add(t)}}else if(e.startsWith("--")){let s=O(this,yt)[yt](e,null);s.push(t),s.add(t),this.flags|=8,this.custom.set(e,s)}}}function kt(t,e){let s=e?e.prop:t;if(!e){if(!this.custom.has(t)){let e=new tt(t,this.root,this.element);this.custom.set(t,e)}return this.custom.get(t)}if(!this[s]){let i=new bt(e,t,this.root,this.element);this[s]=i}return this[s]}class xt{constructor(t,e,s){var i;this.keyMap=new Map,this.host=t,this.template=e,this.key=s,this.keyFn=this.key?this.keyKeyed:this.keyNonKeyed;let r=null!=(i=this.host.ownerDocument)?i:document;this.start=r.createComment("each(items)"),this.end=r.createComment("end each(items)"),this.host.append(this.start),this.start.after(this.end),this.frags=[],this.keys=[]}set(t){return this.updateValues(t)}setData(t,e,s){let i=E("Item"),r=E("Index");for(let n of t.nodes)"dataset"in n&&(n.dataset[i]="",n[Symbol.for(i)]=e,n.dataset[r]="",n[Symbol.for(r)]=s)}render(t,e){let s=(this.host.ownerDocument||document).importNode(this.template.content,!0);return s.nodes=Array.from(s.childNodes),s.data={item:e,index:t},this.setData(s,e,t),s}keyNonKeyed(t,e){return e}keyKeyed(t){return t[this.key]}refrag(t){return!t.firstChild&&t.nodes&&t.append(...t.nodes),t}append(t,e){(e?e.nodes[e.nodes.length-1]:this.start).after(this.refrag(t))}before(t,e){(e?e.nodes[0]:this.end).before(this.refrag(t))}remove(t){this.clear(t.nodes[0],t.nodes[t.nodes.length-1].nextSibling)}clear(t=this.start.nextSibling,e=this.end){let s,i=t;for(;i!==e;)s=i.nextSibling,i.remove(),i=s}updateFrag(t,e,s){return t.data.item===s&&t.data.index===e||this.setData(t,s,e),t}updateValues(t=[]){let e=!1,s=this.frags,i=[],r=this.keys,n=new Map,a=[];for(let e=0,s=t.length;e<s;e++){let s=this.keyFn(t[e],e);n.set(s,t[e]),a[e]=s}let l=0,o=t.length-1,h=0,u=s.length-1;for(;h<=u&&l<=o;)if(null===s[h])h++;else if(null===s[u])u--;else if(r[h]===a[l])i[l]=this.updateFrag(s[h],l,t[l]),h++,l++;else if(r[u]===a[o])i[o]=this.updateFrag(s[u],l,t[o]),u--,o--;else if(r[h]===a[o])i[o]=this.updateFrag(s[h],l,t[o]),this.before(s[h],i[o+1]),h++,o--;else if(r[u]===a[l])i[l]=this.updateFrag(s[u],l,t[l]),this.before(s[u],s[h]),u--,l++;else if(n.has(r[h]))if(n.has(r[u])){let e=t[l],r=this.keyMap.get(this.keyFn(e,l));void 0===r?(r=this.render(l,e),this.keyMap.set(this.keyFn(e,l),r)):(r=this.updateFrag(r,l,e),s[s.indexOf(r)]=null),i[l]=r,this.append(r,s[l-1]),l++}else this.remove(s[u]),u--;else this.remove(s[h]),h++;for(;l<=o;){let s=this.render(l,t[l]);this.keyMap.set(this.keyFn(s.data.item,l),s),this.append(s,i[l-1]),i[l++]=s,e=!0}for(;h<=u;){let t=s[h];this.keyMap.delete(this.keyFn(t.data.item,h)),h++,this.remove(t),e=!0}return this.keys=a,this.frags=i,e}}let Ot=new Map;function Mt(t,e,...s){let i=e.call(t.behavior,...s);return t.update(),i}function Vt(t){this.element=t.rootElement,this.rebind=t.update.bind(t),this.stores=new Map}class Et{constructor(t,e,s){this.rootElement=t,this.props=s||null,this.context=new Vt(this),this.behavior=new e(s,this.context),this.bindings=null,this.callbacks=new WeakMap,this.parent=null}getCallback(t){if(this.callbacks.has(t))return this.callbacks.get(t);let e=Mt.bind(null,this,t);return this.callbacks.set(t,e),e}update(){return this.bindings=this.behavior.bind(this.props,this.context),this.bindings.update(this)}unmount(){this.bindings&&this.bindings.unmount(this)}}function Pt(t,e,s){let i=new Et(t,e,s);return i.update(),i}function St(t,e){Ot.set(t,e)}const jt=new WeakMap,At=new WeakMap;function Dt(t,e,s,i){let r=!1,n=e.flags;if(1024&n){if(!(t instanceof HTMLElement))throw new Error("Stores cannot be used on non-HTML elements.");let n=e.storeRoot;if(n.dirty(i)){let e=n.value,u=n.update(i);if(u){var a,l;t.dataset[L(u)]="";let e=new A(s);t[Symbol.for(D(u))]=e,null==(a=s.mount)||null==(l=a.context)||l.stores.set(u,e)}else{var o,h;delete t.dataset[L(e)],delete t[Symbol.for(D(e))],null==(o=s.mount)||null==(h=o.context)||h.stores.delete(e)}r=!0}}if(8&n){if(!(t instanceof HTMLElement))throw new Error("Custom properties cannot be used on non-HTML elements.");for(let[s,r]of e.custom)if(r.dirty(i)){r.update(i);let e=r.getList();t.dataset[P(s)]="",t[Symbol.for(s)]={value:e,compute:r.compute}}}if(2048&n){let s=e.storeSet;if(s.dirty(i)){let e=s.update(i);if(e){let[s,i,r]=e,n=T(s),a=M(t,n,`[${n}]`,D(s));null==a||a.set(i,r)}r=!0}}if(2&e.flags&&"classList"in t){let s=e.classToggle;for(let[e,n]of s.changes(i))t.classList.toggle(e,n),r=!0}if(16&n){let s=e.each;for(let[e,n,a]of s.values(i)){let s;jt.has(t)&&(s=jt.get(t)),s&&s.template===n||(s=new xt(t,n,a),jt.set(t,s)),s.set(e)&&(r=!0)}}t:if(256&n){let s=e.attachTemplate;if(s.dirty(i)){let e=s.update(i);if(Array.isArray(e)&&(e=e[0]),void 0===e)break t;let n=(t.ownerDocument||document).importNode(e.content,!0);t.replaceChildren(n),r=!0,i.flags|=256}}if(64&n&&t instanceof Element)for(let[s,n,a]of e.attr.changes(i))a?t.setAttribute(s,n):t.removeAttribute(s),r=!0;if(128&n){let s=e.data;for(let[e,n]of s.changes(i))void 0===n?delete t.dataset[e]:t.dataset[e]=n,r=!0}t:if(1&n){let s=e.text;if(s.dirty(i)){let e=s.update(i);if(256&i.flags)break t;Array.isArray(e)&&(e=e.join("")),t.textContent=e}}if(32&n){let s=e.prop;for(let[e,r]of s.changes(i))t[e]=r}if(512&n){let n=e.behavior;for(let[e,a,l]of n.changes(i)){let i,n=void 0!==l,o=n&&l===e;if(At.has(t)?i=At.get(t):(i=new Map,At.set(t,i)),n||o){let t=i.get(l);o?t.update()&&(r=!0):t.unmount()}if(!o&&null!==e){let n=new Et(t,e,a);n.parent=s.mount,n.update()&&(r=!0),i.set(e,n)}}}if(4&n){let r=e.event;for(let[e,n,a,l,o,h,u,c,f]of r.changes(i))void 0!==c&&t.removeEventListener(e,s.getCallback(c),f),n&&t.addEventListener(e,s.getCallback(n),{capture:a,once:l,passive:o,signal:h})}return r}function Tt(t,e,s){let i=!1;for(let[r,n]of t)Dt(r,n,e,s)&&(i=!0);return i}function Lt(t,e,s){let i=e.flags;if(512&i){let s=e.behavior,i=At.get(t);for(let[t]of s.current()){var r;null==(r=i.get(t))||r.unmount()}}if(4&i){let i=e.event;for(let[e,r,n]of i.current())t.removeEventListener(r,s.getCallback(n))}}class Ct{constructor(t){this.values=t,this.selectors=!0,this.flags=0}}const Nt=t=>t;class Wt{constructor(t,e){this.mount=t instanceof Et?t:null,this.rootElement=this.mount?this.mount.rootElement:t,this.rules=e.rules,this.bindingMap=new Map,this.getCallback=this.mount?this.mount.getCallback.bind(this.mount):Nt,this.values=null,this.queue=0}update(t=this.values){if(this.values=t,this.queue++,this.queue>1)return!1;let e=!0,s=!1;for(;e;){let i=new Ct(t);this.collect(),e=Tt(this.bindingMap,this,i),e&&(s=!0)}var i,r;return s&&(null==(i=this.mount)||null==(r=i.parent)||r.update()),this.queue=0,s}collect(){let t=this.rootElement;for(let e of this.rules)for(let s of e.querySelectorAll(t)){let t;this.bindingMap.has(s)?t=this.bindingMap.get(s):(t=new wt(this,s),this.bindingMap.set(s,t));for(let s of e.declarations)t.add(s)}}unmount(){!function(t,e){for(let[s,i]of t)Lt(s,i,e)}(this.bindingMap,this)}}class Ft{constructor(){this.rules=[]}addRule(t){this.rules.push(t)}}class Ut{constructor(t,e){this.roots=new WeakMap,this.sheet=t,this.values=e}update(t){let e;return this.roots.has(t)?e=this.roots.get(t):(e=new Wt(t,this.sheet),this.roots.set(t,e)),e.update(this.values)}unmount(t){this.roots.has(t)&&this.roots.get(t).unmount()}}const $t={};function qt(){return Object.create($t,{fns:{enumerable:!0,value:new Map}})}const Kt=qt(),Ht=qt();function Rt(t,e){this.fns.set(t,e)}function Bt(t,e){if(!t.startsWith("--"))throw new Error("Custom functions must start with --");let s=this;s&&$t.isPrototypeOf(s)||(s=Kt),Rt.call(s,t,e)}Rt.call(Kt,"get",class{constructor(){this.value=C}check([t,e]){if("object"==typeof t&&"function"!=typeof e){let s=S in t?t[S](e):t[e];if(s!==this.value)return this.value=s,!0}return!1}call([t,e]){return"function"==typeof e?e(t):S in t?t[S](e):t[e]}}),Rt.call(Kt,"select",class{call([t],e,{rootElement:s}){return s.querySelector(t)}});class It{constructor(t,e){this.dataPropName="data-corset-"+t,this.dataSelector="["+this.dataPropName+"]",this.propName=e,this.value=C}check([],t,{element:e},s){let i=!1;if(s.selectors&&(i=!0),i){let t=M(e,this.dataPropName,this.dataSelector,this.propName);if(t!==this.value)return this.value=t,!0}return!1}call(){return this.value}}Rt.call(Kt,"item",class extends It{constructor(){super("item","corsetItem")}}),Rt.call(Kt,"index",class extends It{constructor(){super("index","corsetIndex")}}),Rt.call(Kt,"store-get",class{constructor(){this.value=void 0}check([t,e],s,{element:i},r){if(r.selectors){let s=T(t),r=M(i,s,`[${s}]`,D(t));if((null==r?void 0:r.get(e))!==this.value)return this.value=null==r?void 0:r.get(e),!0}return!1}call(){return this.value}}),Rt.call(Kt,"store",class{constructor(){this.map=void 0}check([t],e,{element:s},i){if(i.selectors){let e=T(t),i=M(s,e,`[${e}]`,D(t));if(i!==this.map)return this.map=i,!0}return!1}call(){return this.map}}),Rt.call(Kt,"bind",class{call([t,...e]){function s(...s){return t.call(this,...e,...s)}return Object.defineProperty(s,"name",{value:"bound "+t.name}),s}}),Rt.call(Kt,"data",class{call([t],e,{element:s}){if(!(s instanceof HTMLElement))throw new Error("data() only works on HTMLElements.");return s.dataset[t]}}),Rt.call(Kt,"mount",class{constructor(){this.compute=null,this.Behavior=null,this.value=null}check([t],e,s,i){let r=t;if("string"==typeof t){let e=t;if(!Ot.has(e))throw new Error(`Unregistered behavior ${e}`);r=Ot.get(e)}if(r!==this.Behavior){let t=N(r);t.inputProperties=r.inputProperties;let e=ut(t);return this.Behavior=r,this.compute=new Z(e,Object.getPrototypeOf(s)),this.compute.check(i),this.value=Object.freeze([r,this.compute.inputProps]),!0}if(this.compute){let t=this.compute.dirty(i);return this.compute.check(i),t}return!1}call([]){return this.value}});let _t=new Map([[3,lt],[4,ot]]);function zt(t){let e=t>>2,s=e+3,i=a[e];switch(i){case 1:return ut(W,[ut(N(a[s]))]);case 2:case 3:return ut(N(p(a[s],a[s+1])));case 4:{let t,e=p(a[s],a[s+1]);switch(!0){case"var"===e:t=q;break;case Kt.fns.has(e):{let s=Kt.fns.get(e);t=H(s);break}case Ht.fns.has(e):{let s=Ht.fns.get(e);t=H(s);break}case e.startsWith("--"):{let s=function(t){class e{call(e,s,i){let r=s.get(t);if("function"!=typeof r)throw new Error(`Unable to find the custom function ${t}`);return r.apply(i,e)}}return e.inputProperties=[t],Bt.call(Ht,t,e),e}(e);t=H(s);break}default:throw new Error(`Unknown function ${e}`)}let i=[],r=a[s+3];for(;r;)i.push(zt(r)),r=a[1+(r>>2)];return ut(t,i)}case 6:return ut(N(Boolean(a[s])));case 7:return ut(N(nt.for(p(a[s],a[s+1]))));case 8:return ut(N(_t.get(a[s])));default:throw new Error(`Unknown value type [${i}]`)}}const Zt=new WeakMap;function Gt(t,...s){let c=function(t,s){if(Zt.has(t))return Zt.get(t);let c=function(t,s){let c,v=new Ft,b=0;for(function(t,s){let i=s.map(t=>"ins()"),c=String.raw(t,...i);const f=u.encode(c);d=f.byteLength;const p=r(d);n.set(f,p),h=n.subarray(p);const m=e();l=n.subarray(m),o=a.subarray(m>>2)}(t,s);i(d);)switch(l[0]){case 1:c=new w(p(o[1],o[2])),v.addRule(c);break;case 2:{let t=f(h,o[1],o[2]),e=o[4],s=o[3],i=m[t],r=[],n=r;for(;e;)5===a[e>>2]?(r===n&&(r=[]),r.push(ut(F,n)),n=[]):n.push(zt(e)),e=a[1+(e>>2)];let l,u=r!==n;switch(8&(null==i?void 0:i.feat)&&!u&&(r=[]),(u||8&(null==i?void 0:i.feat))&&r.push(ut(F,n)),!0){case!!(8&(null==i?void 0:i.feat)):l=ut(U,r);break;case!!(2&(null==i?void 0:i.feat))||s>1:l=ut(u?U:F,r);break;default:l=r[0]}let d=new g(c,t,b++,l);d.init(),c.addDeclaration(d);break}case 4:{let t=o[1];switch(t){case 1:case 2:{let e=o[2];if(39===e)throw new SyntaxError("Saw the a single quote character ('). Use double quotes (\") for strings.");throw new SyntaxError(`Unexpected token "${String.fromCharCode(e)}" found. Error code ${t}.`)}default:throw new Error(`Unknown Parse error occurred. Error code [${t}]`)}}}return v}(t,s),v=new Ut(c,s);return Zt.set(t,v),v}(t,s);return c.values=s,c}export{Gt as default,Pt as mount,St as registerBehavior,Bt as registerCustomFunction,Gt as sheet};
//# sourceMappingURL=main.js.map
